<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <link rel="stylesheet" href="map.css">
</head>

<body>
    <div id="map"></div>
    
    <!--<div id="filtres">
        <fieldset>          
            <div>
              <input type="checkbox" id="div1" name="div1" onclick="validate()"/>
              <label for="divisions">Division 1</label>
              <br>
              <input type="checkbox" id="div2" name="div2" onclick="validate()"/>
              <label for="divisions">Division 2</label>
              <br>
              <input type="checkbox" id="div3" name="div3" onclick="validate()"/>
              <label for="divisions">Division 3</label>
            </div>
        </fieldset>
    </div>
    <div id="filtres2">
        <fieldset>          
            <div>
              <input type="checkbox" id="s1" name="s1" onclick="validateSaison()"/>
              <label for="saisons">S1</label>
              <br>
              <input type="checkbox" id="s2" name="s2" onclick="validateSaison()"/>
              <label for="saisons">S2</label>
              <br>
              <input type="checkbox" id="s3" name="s3" onclick="validateSaison()"/>
              <label for="saisons">S3</label>
              <br>
              <input type="checkbox" id="s4" name="s4" onclick="validateSaison()"/>
              <label for="saisons">S4</label>
              <br>
              <input type="checkbox" id="s5" name="s5" onclick="validateSaison()"/>
              <label for="saisons">S5</label>
              <br>
              <input type="checkbox" id="s6" name="s6" onclick="validateSaison()"/>
              <label for="saisons">S6</label>
              <br>
              <input type="checkbox" id="s7" name="s7" onclick="validateSaison()"/>
              <label for="saisons">S7</label>
            </div>
        </fieldset>
    </div>-->
    
    <div id="display">
        <p>Affichage</p>
        <input type="radio" id="marker" name="display" checked onclick="changeDisplay()"/>
        <label for="divisions">Tous les marqueurs</label>
        <br>
        <input type="radio" id="cluster" name="display" onclick="changeDisplay()"/>
        <label for="divisions">Clusters</label>
    </div>

    <div id="competition">
        <p>Comp√©tition</p>
        <input type="radio" id="ligue" name="competition" checked onclick="changeCompetition(this)"/>
        <label for="divisions">La Ligue</label>
        <br>
        <input type="radio" id="cactus" name="competition" onclick="changeCompetition(this)"/>
        <label for="divisions">Cactus Ligue</label>
    </div>

    <div id="filtresAll">
        <p>Filtres</p>
        <table>
            <tr>
                <td></td>
                <td></td>
                <td>D1</td>
                <td>D2</td>
                <td>D3</td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td><input type="checkbox" id="div1All" name="div1All" onclick="checkBoxAllDiv(this)"/></td>
                <td><input type="checkbox" id="div2All" name="div2All" onclick="checkBoxAllDiv(this)"/></td>
                <td><input type="checkbox" id="div3All" name="div3All" onclick="checkBoxAllDiv(this)"/></td>
            </tr>
            <tr>
                <td>S1</td>
                <td><input type="checkbox" id="allS1" name="allS1" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S1" name="div1S1" onclick="checkBoxSingle(this)"/></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>S2</td>
                <td><input type="checkbox" id="allS2" name="allS2" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S2" name="div1S2" onclick="checkBoxSingle(this)"/></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>S3</td>
                <td><input type="checkbox" id="allS3" name="allS3" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S3" name="div1S3" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S3" name="div2S3" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S3" name="div3S3" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S4</td>
                <td><input type="checkbox" id="allS4" name="allS4" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S4" name="div1S4" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S4" name="div2S4" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S4" name="div3S4" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S5</td>
                <td><input type="checkbox" id="allS5" name="allS5" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S5" name="div1S5" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S5" name="div2S5" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S5" name="div3S5" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S6</td>
                <td><input type="checkbox" id="allS6" name="allS6" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S6" name="div1S6" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S6" name="div2S6" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S6" name="div3S6" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S7</td>
                <td><input type="checkbox" id="allS7" name="allS7" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S7" name="div1S7" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S7" name="div2S7" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S7" name="div3S7" onclick="checkBoxSingle(this)"/></td>
            </tr>
        </table>
    </div>
    
    <div id="filtresCactus">
        <p>Filtres</p>
        <table>
            <tr>
                <td></td>
                <td><input type="checkbox" id="cactusAll" name="cactusAll" onclick="checkBoxAllCactus(this)"/></td>
            </tr>
            <tr>
                <td>S1</td>
                <td><input type="checkbox" id="cactusS1" name="cactusS1" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S2</td>
                <td><input type="checkbox" id="cactusS2" name="cactusS2" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S3</td>
                <td><input type="checkbox" id="cactusS3" name="cactusS3" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S4</td>
                <td><input type="checkbox" id="cactusS4" name="cactusS4" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S5</td>
                <td><input type="checkbox" id="cactusS5" name="cactusS5" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S6</td>
                <td><input type="checkbox" id="cactusS6" name="cactusS6" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S7</td>
                <td><input type="checkbox" id="cactusS7" name="cactusS7" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
        </table>
    </div>

    <script>
        function getGoogleLink(lat, lng, panoId, heading, pitch, zoom){
            let fov = 90;
            if (zoom !=null) {
                fov = 180 / Math.pow(2, Math.min(Math.max(zoom, 0), 4));
            }
            if (panoId != null) {
                return "https://www.google.com/maps/@?api=1&map_action=pano&pano=" + panoId + "&viewpoint=" + lat + "," + lng + "&heading=" + heading + "&pitch=" + pitch + "&fov=" + fov;
            } else {
                return "https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=" + lat + "," + lng + "&heading=" + heading + "&pitch=" + pitch + "&fov=" + fov;
            }
        }

        var redIcon = new L.Icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });
        var greenIcon = new L.Icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        var map = L.map('map').setView([0, 0], 2);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        
        var cluster = false;
        var layerGroup = L.layerGroup();

        function fetchJSONDataAll() {
            fetch("coordinatesAll.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(data[i].name.includes('L1') || data[i].name.includes('D1')){
                            L.marker([data[i].lat, data[i].lng], {icon: greenIcon}).addTo(map).bindPopup(data[i].name)
                        }
                        else if(data[i].name.includes('L2') || data[i].name.includes('D2')){
                            L.marker([data[i].lat, data[i].lng], {icon: redIcon}).addTo(map).bindPopup(data[i].name)
                        }
                        else if(data[i].name.includes('L3') || data[i].name.includes('D3')){
                            L.marker([data[i].lat, data[i].lng]).addTo(map).bindPopup(data[i].name)
                        }
                        else{
                            if(!data[i].name.includes('J0') && !data[i].name.includes('S2') && !data[i].name.includes('S1')){
                                console.log(data[i].name);
                            }
                        }
                    }
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }
        
        function fetchJSONDataDiv(div) {
            fetch("coordinatesAll.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(div === "D1" && (data[i].name.includes('L1') || data[i].name.includes('D1'))){
                            var marker = L.marker([data[i].lat, data[i].lng], {icon: greenIcon}).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(div === "D2" && (data[i].name.includes('L2') || data[i].name.includes('D2'))){
                            var marker = L.marker([data[i].lat, data[i].lng], {icon: redIcon}).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(div === "D3" && (data[i].name.includes('L3') || data[i].name.includes('D3'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                    }
                    map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }

        function fetchJSONDataSeason(saison) {
            fetch("coordinatesAll.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(saison === "S1" && (data[i].name.includes('S1'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(saison === "S2" && (data[i].name.includes('S2'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(saison === "S3" && (data[i].name.includes('S3'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(saison === "S4" && (data[i].name.includes('S4'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(saison === "S5" && (data[i].name.includes('S5'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(saison === "S6" && (data[i].name.includes('S6'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }
                        else if(saison === "S7" && (data[i].name.includes('S7'))){
                            var marker = L.marker([data[i].lat, data[i].lng]).bindPopup(data[i].name);
                            layerGroup.addLayer(marker);
                        }

                    }
                    map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }

        function fetchJSONData(filter){
            fetch("coordinatesAll.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(filter === "S1"){
                            if(data[i][1].includes('S1')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S2"){
                            if(data[i][1].includes('S2')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S3"){
                            if(data[i][1].includes('S3')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S4"){
                            if(data[i][1].includes('S4')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S5"){
                            if(data[i][1].includes('S5')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S6"){
                            if(data[i][1].includes('S6')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S7"){
                            if(data[i][1].includes('S7')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                    }
                    map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }

        function fetchJSONDataCactus(filter){
            fetch("coordinatesCactus.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(filter === "S1"){
                            if(data[i][1].includes('S1')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S2"){
                            if(data[i][1].includes('S2')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S3"){
                            if(data[i][1].includes('S3')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S4"){
                            if(data[i][1].includes('S4')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S5"){
                            if(data[i][1].includes('S5')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S6"){
                            if(data[i][1].includes('S6')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S7"){
                            if(data[i][1].includes('S7')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                    }
                    map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }


        function validate() {
            if (document.getElementById('div1').checked) {
                fetchJSONDataDiv("D1");
            } 
            if (document.getElementById('div2').checked) {
                fetchJSONDataDiv("D2");
            } 
            if (document.getElementById('div3').checked) {
                fetchJSONDataDiv("D3");
            } 
        }
        
        function validateSaison() {
            if (document.getElementById('s1').checked) {
                fetchJSONDataSeason("S1");
            } 
            if (document.getElementById('s2').checked) {
                fetchJSONDataSeason("S2");
            }
            if (document.getElementById('s3').checked) {
                fetchJSONDataSeason("S3");
            }
            if (document.getElementById('s4').checked) {
                fetchJSONDataSeason("S4");
            }
            if (document.getElementById('s5').checked) {
                fetchJSONDataSeason("S5");
            }
            if (document.getElementById('s6').checked) {
                fetchJSONDataSeason("S6");
            }
            if (document.getElementById('s7').checked) {
                fetchJSONDataSeason("S7");
            }
        }

        function changeDisplay(){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }

            if(document.getElementById('marker').checked){
                layerGroup = L.layerGroup();
            }
            else if(document.getElementById('cluster').checked){
                layerGroup = L.markerClusterGroup();
            }

            if(document.getElementById('ligue').checked){
                fetchData();
            }
            else if(document.getElementById('cactus').checked){
                fetchDataCactus();
            }
        }

        function changeCompetition(elem){
            var id = elem.id;

            if(id === 'ligue'){
                document.getElementById('filtresCactus').style.display = 'none';
                document.getElementById('filtresAll').style.display = 'block';
                fetchData();
            }
            else if(id === 'cactus'){
                document.getElementById('filtresCactus').style.display = 'block';
                document.getElementById('filtresAll').style.display = 'none';
                fetchDataCactus();
            }
        }

        function checkBoxAllDiv(elem){
            var id = elem.id;

            if(id === 'div1All'){
                if (elem.checked) {
                    document.getElementById('div1S1').checked = true;
                    document.getElementById('allS1').checked = true;
                    document.getElementById('div1S2').checked = true;
                    document.getElementById('allS2').checked = true;
                    document.getElementById('div1S3').checked = true;
                    document.getElementById('div1S4').checked = true;
                    document.getElementById('div1S5').checked = true;
                    document.getElementById('div1S6').checked = true;
                    document.getElementById('div1S7').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S1').checked = false;
                    document.getElementById('allS1').checked = false;
                    document.getElementById('div1S2').checked = false;
                    document.getElementById('allS2').checked = false;
                    document.getElementById('div1S3').checked = false;
                    document.getElementById('div1S4').checked = false;
                    document.getElementById('div1S5').checked = false;
                    document.getElementById('div1S6').checked = false;
                    document.getElementById('div1S7').checked = false;
                }
            }
            
            if(id === 'div2All'){
                if (elem.checked) {
                    document.getElementById('div2S3').checked = true;
                    document.getElementById('div2S4').checked = true;
                    document.getElementById('div2S5').checked = true;
                    document.getElementById('div2S6').checked = true;
                    document.getElementById('div2S7').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div2S3').checked = false;
                    document.getElementById('div2S4').checked = false;
                    document.getElementById('div2S5').checked = false;
                    document.getElementById('div2S6').checked = false;
                    document.getElementById('div2S7').checked = false;
                }
            }
            if(id === 'div3All'){
                if (elem.checked) {
                    document.getElementById('div3S3').checked = true;
                    document.getElementById('div3S4').checked = true;
                    document.getElementById('div3S5').checked = true;
                    document.getElementById('div3S6').checked = true;
                    document.getElementById('div3S7').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div3S3').checked = false;
                    document.getElementById('div3S4').checked = false;
                    document.getElementById('div3S5').checked = false;
                    document.getElementById('div3S6').checked = false;
                    document.getElementById('div3S7').checked = false;
                }
            }
            fetchData();
        }

        function checkBoxAllSeason(elem){
            var id = elem.id;

            if(id === 'allS1'){
                if (elem.checked) {
                    document.getElementById('div1S1').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S1').checked = false;
                }
            }

            if(id === 'allS2'){
                if (elem.checked) {
                    document.getElementById('div1S2').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S2').checked = false;
                }
            }

            if(id === 'allS3'){
                if (elem.checked) {
                    document.getElementById('div1S3').checked = true;
                    document.getElementById('div2S3').checked = true;
                    document.getElementById('div3S3').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S3').checked = false;
                    document.getElementById('div2S3').checked = false;
                    document.getElementById('div3S3').checked = false;
                }
            }

            if(id === 'allS4'){
                if (elem.checked) {
                    document.getElementById('div1S4').checked = true;
                    document.getElementById('div2S4').checked = true;
                    document.getElementById('div3S4').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S4').checked = false;
                    document.getElementById('div2S4').checked = false;
                    document.getElementById('div3S4').checked = false;
                }
            }

            if(id === 'allS5'){
                if (elem.checked) {
                    document.getElementById('div1S5').checked = true;
                    document.getElementById('div2S5').checked = true;
                    document.getElementById('div3S5').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S5').checked = false;
                    document.getElementById('div2S5').checked = false;
                    document.getElementById('div3S5').checked = false;
                }
            }

            if(id === 'allS6'){
                if (elem.checked) {
                    document.getElementById('div1S6').checked = true;
                    document.getElementById('div2S6').checked = true;
                    document.getElementById('div3S6').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S6').checked = false;
                    document.getElementById('div2S6').checked = false;
                    document.getElementById('div3S6').checked = false;
                }
            }

            if(id === 'allS7'){
                if (elem.checked) {
                    document.getElementById('div1S7').checked = true;
                    document.getElementById('div2S7').checked = true;
                    document.getElementById('div3S7').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S7').checked = false;
                    document.getElementById('div2S7').checked = false;
                    document.getElementById('div3S7').checked = false;
                }
            }

            fetchData();
        }

        function checkBoxSingle(elem){
            var id = elem.id;

            if(id === 'div1S1'){
                if (elem.checked) {
                    document.getElementById('allS1').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('allS1').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
            }

            if(id === 'div1S2'){
                if (elem.checked) {
                    document.getElementById('allS2').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('allS2').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
            }

            if(id === 'div1S3'){
                if (!elem.checked && document.getElementById('allS3').checked) {
                    document.getElementById('allS3').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S3').checked && document.getElementById('div3S3').checked){
                    document.getElementById('allS3').checked = true;
                }
            }

            if(id === 'div2S3'){
                if (!elem.checked && document.getElementById('allS3').checked) {
                    document.getElementById('allS3').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S3').checked && document.getElementById('div3S3').checked){
                    document.getElementById('allS3').checked = true;
                }
            }

            if(id === 'div3S3'){
                if (!elem.checked && document.getElementById('allS3').checked) {
                    document.getElementById('allS3').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S3').checked && document.getElementById('div1S3').checked){
                    document.getElementById('allS3').checked = true;
                }
            }

            if(id === 'div1S4'){
                if (!elem.checked && document.getElementById('allS4').checked) {
                    document.getElementById('allS4').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S4').checked && document.getElementById('div3S4').checked){
                    document.getElementById('allS4').checked = true;
                }
            }
            if(id === 'div2S4'){
                if (!elem.checked && document.getElementById('allS4').checked) {
                    document.getElementById('allS4').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S4').checked && document.getElementById('div3S4').checked){
                    document.getElementById('allS4').checked = true;
                }
            }
            if(id === 'div3S4'){
                if (!elem.checked && document.getElementById('allS4').checked) {
                    document.getElementById('allS4').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S4').checked && document.getElementById('div1S4').checked){
                    document.getElementById('allS4').checked = true;
                }
            }
            
            if(id === 'div1S5'){
                if (!elem.checked && document.getElementById('allS5').checked) {
                    document.getElementById('allS5').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S5').checked && document.getElementById('div3S5').checked){
                    document.getElementById('allS5').checked = true;
                }
            }

            if(id === 'div2S5'){
                if (!elem.checked && document.getElementById('allS5').checked) {
                    document.getElementById('allS5').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S5').checked && document.getElementById('div3S5').checked){
                    document.getElementById('allS5').checked = true;
                }
            }

            if(id === 'div3S5'){
                if (!elem.checked && document.getElementById('allS5').checked) {
                    document.getElementById('allS5').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S5').checked && document.getElementById('div1S5').checked){
                    document.getElementById('allS5').checked = true;
                }
            }
            
            if(id === 'div1S6'){
                if (!elem.checked && document.getElementById('allS6').checked) {
                    document.getElementById('allS6').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S6').checked && document.getElementById('div3S6').checked){
                    document.getElementById('allS6').checked = true;
                }
            }

            if(id === 'div2S6'){
                if (!elem.checked && document.getElementById('allS6').checked) {
                    document.getElementById('allS6').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S6').checked && document.getElementById('div3S6').checked){
                    document.getElementById('allS6').checked = true;
                }
            }

            if(id === 'div3S6'){
                if (!elem.checked && document.getElementById('allS6').checked) {
                    document.getElementById('allS6').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S6').checked && document.getElementById('div1S6').checked){
                    document.getElementById('allS6').checked = true;
                }
            }

            if(id === 'div1S7'){
                if (!elem.checked && document.getElementById('allS7').checked) {
                    document.getElementById('allS7').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S7').checked && document.getElementById('div3S7').checked){
                    document.getElementById('allS7').checked = true;
                }
            }

            if(id === 'div2S7'){
                if (!elem.checked && document.getElementById('allS7').checked) {
                    document.getElementById('allS7').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S7').checked && document.getElementById('div3S7').checked){
                    document.getElementById('allS7').checked = true;
                }
            }

            if(id === 'div3S7'){
                if (!elem.checked && document.getElementById('allS7').checked) {
                    document.getElementById('allS7').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S7').checked && document.getElementById('div1S7').checked){
                    document.getElementById('allS7').checked = true;
                }
            }

            fetchData();
        }

        function checkBoxAllCactus(elem){
            var id = elem.id;

            if (elem.checked) {
                document.getElementById('cactusS1').checked = true;
                document.getElementById('cactusS2').checked = true;
                document.getElementById('cactusS3').checked = true;
                document.getElementById('cactusS4').checked = true;
                document.getElementById('cactusS5').checked = true;
                document.getElementById('cactusS6').checked = true;
                document.getElementById('cactusS7').checked = true;
            }
            else if (!elem.checked) {
                document.getElementById('cactusS1').checked = false;
                document.getElementById('cactusS2').checked = false;
                document.getElementById('cactusS3').checked = false;
                document.getElementById('cactusS4').checked = false;
                document.getElementById('cactusS5').checked = false;
                document.getElementById('cactusS6').checked = false;
                document.getElementById('cactusS7').checked = false;
            }

            fetchDataCactus();
        }

        function checkBoxAllSeasonCactus(elem){
            var id = elem.id;

            if (!elem.checked && document.getElementById('cactusAll').checked) {
                document.getElementById('cactusAll').checked = false;
            }

            fetchDataCactus();
        }


        function fetchData(){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }

            if (document.getElementById('div1S1').checked) {
                fetchJSONData("S1");
            }

            if (document.getElementById('div1S2').checked) {
                fetchJSONData("S2");
            }

            if (document.getElementById('allS3').checked) {
                fetchJSONData("S3");
            }
            else {
                if (document.getElementById('div1S3').checked) {
                    fetchJSONData("D1S3");
                }
                if (document.getElementById('div2S3').checked) {
                    fetchJSONData("D2S3");
                }
                if (document.getElementById('div3S3').checked) {
                    fetchJSONData("D3S3");
                }
            }

            if (document.getElementById('allS4').checked) {
                fetchJSONData("S4");
            }
            else {
                if (document.getElementById('div1S4').checked) {
                    fetchJSONData("D1S4");
                }
                if (document.getElementById('div2S4').checked) {
                    fetchJSONData("D2S4");
                }
                if (document.getElementById('div3S4').checked) {
                    fetchJSONData("D3S4");
                }
            }

            if (document.getElementById('allS5').checked) {
                fetchJSONData("S5");
            }
            else {
                if (document.getElementById('div1S5').checked) {
                    fetchJSONData("D1S5");
                }
                if (document.getElementById('div2S5').checked) {
                    fetchJSONData("D2S5");
                }
                if (document.getElementById('div3S5').checked) {
                    fetchJSONData("D3S5");
                }
            }

            if (document.getElementById('allS6').checked) {
                fetchJSONData("S6");
            }
            else {
                if (document.getElementById('div1S6').checked) {
                    fetchJSONData("D1S6");
                }
                if (document.getElementById('div2S6').checked) {
                    fetchJSONData("D2S6");
                }
                if (document.getElementById('div3S6').checked) {
                    fetchJSONData("D3S6");
                }
            }

            if (document.getElementById('allS7').checked) {
                fetchJSONData("S7");
            }
            else {
                if (document.getElementById('div1S7').checked) {
                    fetchJSONData("D1S7");
                }
                if (document.getElementById('div2S7').checked) {
                    fetchJSONData("D2S7");
                }
                if (document.getElementById('div3S7').checked) {
                    fetchJSONData("D3S7");
                }
            }

        }

        function fetchDataCactus(){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }

            if (document.getElementById('cactusS1').checked) {
                fetchJSONDataCactus("S1");
            }

            if (document.getElementById('cactusS2').checked) {
                fetchJSONDataCactus("S2");
            }

            if (document.getElementById('cactusS3').checked) {
                fetchJSONDataCactus("S3");
            }

            if (document.getElementById('cactusS4').checked) {
                fetchJSONDataCactus("S4");
            }

            if (document.getElementById('cactusS5').checked) {
                fetchJSONDataCactus("S5");
            }

            if (document.getElementById('cactusS6').checked) {
                fetchJSONDataCactus("S6");
            }

            if (document.getElementById('cactusS7').checked) {
                fetchJSONDataCactus("S7");
            }
        }

    </script>
</body>
</html>