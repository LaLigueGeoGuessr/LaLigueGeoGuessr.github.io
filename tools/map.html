<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

    <link rel="stylesheet" href="../styles/styleMap.css">
</head>

<body>
    <div id="map"></div>
    
    <div id="display">
        <p>Affichage</p>
        <input type="radio" id="marker" name="display" checked onclick="changeDisplay()"/>
        <label for="divisions">Tous les marqueurs</label>
        <br>
        <input type="radio" id="cluster" name="display" onclick="changeDisplay()"/>
        <label for="divisions">Clusters</label>
    </div>

    <div id="competition">
        <p>Comp√©tition</p>
        <input type="radio" id="ligue" name="competition" checked onclick="changeCompetition(this)"/>
        <label for="divisions">La Ligue</label>
        <br>
        <input type="radio" id="cactus" name="competition" onclick="changeCompetition(this)"/>
        <label for="divisions">Cactus Ligue</label>
    </div>

    <div id="filtresAll">
        <p>Filtres</p>
        <table>
            <tr>
                <td></td>
                <td></td>
                <td id="td_d1">D1</td>
                <td id="td_d2">D2</td>
                <td id="td_d3">D3</td>
                <td id="td_d4">D4</td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td><input type="checkbox" id="div1All" name="div1All" onclick="checkBoxAllDiv(this)"/></td>
                <td><input type="checkbox" id="div2All" name="div2All" onclick="checkBoxAllDiv(this)"/></td>
                <td><input type="checkbox" id="div3All" name="div3All" onclick="checkBoxAllDiv(this)"/></td>
                <td><input type="checkbox" id="div4All" name="div4All" onclick="checkBoxAllDiv(this)"/></td>
            </tr>
            <tr>
                <td>S1</td>
                <td><input type="checkbox" id="allS1" name="allS1" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S1" name="div1S1" onclick="checkBoxSingle(this)"/></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>S2</td>
                <td><input type="checkbox" id="allS2" name="allS2" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S2" name="div1S2" onclick="checkBoxSingle(this)"/></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>S3</td>
                <td><input type="checkbox" id="allS3" name="allS3" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S3" name="div1S3" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S3" name="div2S3" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S3" name="div3S3" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S4</td>
                <td><input type="checkbox" id="allS4" name="allS4" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S4" name="div1S4" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S4" name="div2S4" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S4" name="div3S4" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S5</td>
                <td><input type="checkbox" id="allS5" name="allS5" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S5" name="div1S5" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S5" name="div2S5" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S5" name="div3S5" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S6</td>
                <td><input type="checkbox" id="allS6" name="allS6" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S6" name="div1S6" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S6" name="div2S6" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S6" name="div3S6" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S7</td>
                <td><input type="checkbox" id="allS7" name="allS7" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S7" name="div1S7" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S7" name="div2S7" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S7" name="div3S7" onclick="checkBoxSingle(this)"/></td>
            </tr>
            <tr>
                <td>S8</td>
                <td><input type="checkbox" id="allS8" name="allS8" onclick="checkBoxAllSeason(this)"/></td>
                <td><input type="checkbox" id="div1S8" name="div1S8" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div2S8" name="div2S8" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div3S8" name="div3S8" onclick="checkBoxSingle(this)"/></td>
                <td><input type="checkbox" id="div4S8" name="div4S8" onclick="checkBoxSingle(this)"/></td>
            </tr>
        </table>
    </div>
    
    <div id="filtresCactus">
        <p>Filtres</p>
        <table>
            <tr>
                <td></td>
                <td><input type="checkbox" id="cactusAll" name="cactusAll" onclick="checkBoxAllCactus(this)"/></td>
            </tr>
            <tr>
                <td>S1</td>
                <td><input type="checkbox" id="cactusS1" name="cactusS1" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S2</td>
                <td><input type="checkbox" id="cactusS2" name="cactusS2" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S3</td>
                <td><input type="checkbox" id="cactusS3" name="cactusS3" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S4</td>
                <td><input type="checkbox" id="cactusS4" name="cactusS4" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S5</td>
                <td><input type="checkbox" id="cactusS5" name="cactusS5" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S6</td>
                <td><input type="checkbox" id="cactusS6" name="cactusS6" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S7</td>
                <td><input type="checkbox" id="cactusS7" name="cactusS7" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
            <tr>
                <td>S8</td>
                <td><input type="checkbox" id="cactusS8" name="cactusS8" onclick="checkBoxAllSeasonCactus(this)"/></td>
            </tr>
        </table>
    </div>

    <script>
        function getGoogleLink(lat, lng, panoId, heading, pitch, zoom){
            let fov = 90;
            if (zoom !=null) {
                fov = 180 / Math.pow(2, Math.min(Math.max(zoom, 0), 4));
            }
            if (panoId != null) {
                return "https://www.google.com/maps/@?api=1&map_action=pano&pano=" + panoId + "&viewpoint=" + lat + "," + lng + "&heading=" + heading + "&pitch=" + pitch + "&fov=" + fov;
            } else {
                return "https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=" + lat + "," + lng + "&heading=" + heading + "&pitch=" + pitch + "&fov=" + fov;
            }
        }

        var redIcon = new L.Icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });
        var greenIcon = new L.Icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });
        var orangeIcon = new L.Icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        var map = L.map('map').setView([0, 0], 2);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        
        var cluster = false;
        var layers = [L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup()];
        var layersCactus = [L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup()];
        var layerGroup = L.markerClusterGroup();


        function fetchJSONData(filter){
            fetch("coordinatesAll.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(filter === "S1"){
                            if(data[i][1].includes('S1')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[0].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[0]);
                        }

                        else if(filter === "S2"){
                            if(data[i][1].includes('S2')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[1].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[1]);
                        }

                        else if(filter === "S3"){
                            if(data[i][1].includes('S3')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[2].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[3].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[4].addLayer(marker);
                                    }
                                }
                            }  
                            map.addLayer(layers[2]);
                            map.addLayer(layers[3]);
                            map.addLayer(layers[4]);
                        }
                        else if(filter === "D1S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[2].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[2]);
                        }
                        else if(filter === "D2S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[3].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[3]);
                        }
                        else if(filter === "D3S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[4].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[4]);
                        }

                        else if(filter === "S4"){
                            if(data[i][1].includes('S4')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[5].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[6].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[7].addLayer(marker);
                                    }
                                }
                            }  
                            map.addLayer(layers[5]);
                            map.addLayer(layers[6]);
                            map.addLayer(layers[7]);
                        }
                        else if(filter === "D1S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[5].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[5]);
                        }
                        else if(filter === "D2S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[6].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[6]);
                        }
                        else if(filter === "D3S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[7].addLayer(marker);
                                }
                            } 
                            map.addLayer(layers[7]); 
                        }

                        else if(filter === "S5"){
                            if(data[i][1].includes('S5')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[8].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[9].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[10].addLayer(marker);
                                    }
                                }
                            }  
                            map.addLayer(layers[8]);
                            map.addLayer(layers[9]);
                            map.addLayer(layers[10]);
                        }
                        else if(filter === "D1S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[8].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[8]);
                        }
                        else if(filter === "D2S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[9].addLayer(marker);
                                }
                            } 
                            map.addLayer(layers[9]); 
                        }
                        else if(filter === "D3S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[10].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[10]);
                        }

                        else if(filter === "S6"){
                            if(data[i][1].includes('S6')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[11].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[12].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[13].addLayer(marker);
                                    }
                                }
                            }  
                            map.addLayer(layers[11]);
                            map.addLayer(layers[12]);
                            map.addLayer(layers[13]);
                        }
                        else if(filter === "D1S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[11].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[11]);
                        }
                        else if(filter === "D2S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[12].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[12]);
                        }
                        else if(filter === "D3S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[13].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[13]);
                        }

                        else if(filter === "S7"){
                            if(data[i][1].includes('S7')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[14].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[15].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[16].addLayer(marker);
                                    }
                                }
                            }  
                            map.addLayer(layers[14]);
                            map.addLayer(layers[15]);
                            map.addLayer(layers[16]);
                        }
                        else if(filter === "D1S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[14].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[14]);
                        }
                        else if(filter === "D2S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[15].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[15]);  
                        }
                        else if(filter === "D3S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[16].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[16]);  
                        }

                        else if(filter === "S8"){
                            if(data[i][1].includes('S8')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[17].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[18].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[19].addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L4') || data[i][1].includes('D4')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: orangeIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layers[20].addLayer(marker);
                                    }
                                }
                            }  
                            map.addLayer(layers[17]);
                            map.addLayer(layers[18]);
                            map.addLayer(layers[19]);
                            map.addLayer(layers[20]);
                        }
                        else if(filter === "D1S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[17].addLayer(marker);
                                }
                            }  
                            map.addLayer(layers[17]);
                        }
                        else if(filter === "D2S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[18].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[18]);  
                        }
                        else if(filter === "D3S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[19].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[19]);  
                        }
                        else if(filter === "D4S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L4') || data[i][1].includes('D4'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: orangeIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layers[20].addLayer(marker);
                                }
                            }
                            map.addLayer(layers[20]);  
                        }
                    }
                    //map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }

        function fetchJSONDataCactus(filter){
            fetch("coordinatesCactus.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(filter === "S1"){
                            if(data[i][1].includes('S1')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[0].addLayer(marker);
                                }
                            }  
                            map.addLayer(layersCactus[0]);
                        }

                        else if(filter === "S2"){
                            if(data[i][1].includes('S2')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[1].addLayer(marker);
                                }
                            }  
                            map.addLayer(layersCactus[1]);
                        }

                        else if(filter === "S3"){
                            if(data[i][1].includes('S3')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[2].addLayer(marker);
                                }
                            }  
                            map.addLayer(layersCactus[2]);
                        }

                        else if(filter === "S4"){
                            if(data[i][1].includes('S4')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[3].addLayer(marker);
                                }
                            } 
                            map.addLayer(layersCactus[3]); 
                        }

                        else if(filter === "S5"){
                            if(data[i][1].includes('S5')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[4].addLayer(marker);
                                }
                            }  
                            map.addLayer(layersCactus[4]);
                        }

                        else if(filter === "S6"){
                            if(data[i][1].includes('S6')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[5].addLayer(marker);
                                }
                            } 
                            map.addLayer(layersCactus[5]); 
                        }

                        else if(filter === "S7"){
                            if(data[i][1].includes('S7')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[6].addLayer(marker);
                                }
                            }  
                            map.addLayer(layersCactus[6]);
                        }

                        else if(filter === "S8"){
                            if(data[i][1].includes('S8')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layersCactus[6].addLayer(marker);
                                }
                            }  
                            map.addLayer(layersCactus[7]);
                        }
                    }
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }

        function fetchJSONDataCluster(filter){
            fetch("coordinatesAll.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(filter === "S1"){
                            if(data[i][1].includes('S1')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S2"){
                            if(data[i][1].includes('S2')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S3"){
                            if(data[i][1].includes('S3')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S3"){
                            if(data[i][1].includes('S3') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S4"){
                            if(data[i][1].includes('S4')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S4"){
                            if(data[i][1].includes('S4') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S5"){
                            if(data[i][1].includes('S5')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S5"){
                            if(data[i][1].includes('S5') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S6"){
                            if(data[i][1].includes('S6')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S6"){
                            if(data[i][1].includes('S6') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S7"){
                            if(data[i][1].includes('S7')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S7"){
                            if(data[i][1].includes('S7') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S8"){
                            if(data[i][1].includes('S8')){
                                if(data[i][1].includes('L1') || data[i][1].includes('D1')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L2') || data[i][1].includes('D2')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L3') || data[i][1].includes('D3')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                                else if(data[i][1].includes('L4') || data[i][1].includes('D4')){
                                    for(let j = 0; j < 5; j++){
                                        var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: orangeIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                        layerGroup.addLayer(marker);
                                    }
                                }
                            }  
                        }
                        else if(filter === "D1S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L1') || data[i][1].includes('D1'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D2S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L2') || data[i][1].includes('D2'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: redIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D3S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L3') || data[i][1].includes('D3'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng]).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                        else if(filter === "D4S8"){
                            if(data[i][1].includes('S8') && (data[i][1].includes('L4') || data[i][1].includes('D4'))){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: orangeIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                    }
                    map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }

        function fetchJSONDataCactusCluster(filter){
            fetch("coordinatesCactus.json")
                .then((res) => {
                    if (!res.ok) {
                        throw new Error
                            (`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then((data) => {
                    for(let i = 0; i < data.length; i++){
                        if(filter === "S1"){
                            if(data[i][1].includes('S1')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S2"){
                            if(data[i][1].includes('S2')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S3"){
                            if(data[i][1].includes('S3')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S4"){
                            if(data[i][1].includes('S4')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S5"){
                            if(data[i][1].includes('S5')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S6"){
                            if(data[i][1].includes('S6')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S7"){
                            if(data[i][1].includes('S7')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }

                        else if(filter === "S8"){
                            if(data[i][1].includes('S8')){
                                for(let j = 0; j < 5; j++){
                                    var marker = L.marker([data[i][2+j].lat, data[i][2+j].lng], {icon: greenIcon}).bindPopup(data[i][1] + '<br><br><a href="' + getGoogleLink(data[i][2+j].lat, data[i][2+j].lng, data[i][2+j].panoId, data[i][2+j].heading, data[i][2+j].pitch, data[i][2+j].zoom) + '" target="_blank">Ouvrir le point</a><br><br><a href="https://www.geoguessr.com/challenge/' + data[i][0] + '" target="_blank">Challenge</a>');
                                    layerGroup.addLayer(marker);
                                }
                            }  
                        }
                    }
                    map.addLayer(layerGroup);
                })   
                .catch((error) =>
                    console.error("Unable to fetch data:", error));
        }


        function changeDisplay(){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }
            for(let i = 0; i < layers.length; i++){
                if (map.hasLayer(layers[i])) {
                    layers[i].clearLayers();
                } 
            }
            for(let i = 0; i < layersCactus.length; i++){
                if (map.hasLayer(layersCactus[i])) {
                    layersCactus[i].clearLayers();
                } 
            }

            if(document.getElementById('marker').checked){
                cluster = false;
                layers = [L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup()];
                layersCactus = [L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup(), L.layerGroup()];
                if(document.getElementById('ligue').checked){
                    fetchData();
                }
                else if(document.getElementById('cactus').checked){
                    fetchDataCactus();
                }
            }
            else if(document.getElementById('cluster').checked){
                cluster = true;
                layerGroup = L.markerClusterGroup();
                if(document.getElementById('ligue').checked){
                    fetchDataCluster();
                }
                else if(document.getElementById('cactus').checked){
                    fetchDataCactusCluster();
                }
            }
        }

        function changeCompetition(elem){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }
            for(let i = 0; i < layers.length; i++){
                if (map.hasLayer(layers[i])) {
                    layers[i].clearLayers();
                } 
            }
            for(let i = 0; i < layersCactus.length; i++){
                if (map.hasLayer(layersCactus[i])) {
                    layersCactus[i].clearLayers();
                } 
            }
            
            var id = elem.id;

            if(id === 'ligue'){
                document.getElementById('filtresCactus').style.display = 'none';
                document.getElementById('filtresAll').style.display = 'block';
                if(!cluster){
                    fetchData();
                }
                else{
                    fetchDataCluster();
                }
                
            }
            else if(id === 'cactus'){
                document.getElementById('filtresCactus').style.display = 'block';
                document.getElementById('filtresAll').style.display = 'none';
                
                if(!cluster){
                    fetchDataCactus();
                }
                else{
                    fetchDataCactusCluster();
                }
            }
        }

        function checkBoxAllDiv(elem){
            var id = elem.id;

            if(id === 'div1All'){
                if (elem.checked) {
                    document.getElementById('div1S1').checked = true;
                    document.getElementById('allS1').checked = true;
                    document.getElementById('div1S2').checked = true;
                    document.getElementById('allS2').checked = true;
                    document.getElementById('div1S3').checked = true;
                    document.getElementById('div1S4').checked = true;
                    document.getElementById('div1S5').checked = true;
                    document.getElementById('div1S6').checked = true;
                    document.getElementById('div1S7').checked = true;
                    document.getElementById('div1S8').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S1').checked = false;
                    document.getElementById('allS1').checked = false;
                    document.getElementById('div1S2').checked = false;
                    document.getElementById('allS2').checked = false;
                    document.getElementById('div1S3').checked = false;
                    document.getElementById('div1S4').checked = false;
                    document.getElementById('div1S5').checked = false;
                    document.getElementById('div1S6').checked = false;
                    document.getElementById('div1S7').checked = false;
                    document.getElementById('div1S8').checked = false;
                }
            }
            if(id === 'div2All'){
                if (elem.checked) {
                    document.getElementById('div2S3').checked = true;
                    document.getElementById('div2S4').checked = true;
                    document.getElementById('div2S5').checked = true;
                    document.getElementById('div2S6').checked = true;
                    document.getElementById('div2S7').checked = true;
                    document.getElementById('div2S8').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div2S3').checked = false;
                    document.getElementById('div2S4').checked = false;
                    document.getElementById('div2S5').checked = false;
                    document.getElementById('div2S6').checked = false;
                    document.getElementById('div2S7').checked = false;
                    document.getElementById('div2S8').checked = false;
                }
            }
            if(id === 'div3All'){
                if (elem.checked) {
                    document.getElementById('div3S3').checked = true;
                    document.getElementById('div3S4').checked = true;
                    document.getElementById('div3S5').checked = true;
                    document.getElementById('div3S6').checked = true;
                    document.getElementById('div3S7').checked = true;
                    document.getElementById('div3S8').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div3S3').checked = false;
                    document.getElementById('div3S4').checked = false;
                    document.getElementById('div3S5').checked = false;
                    document.getElementById('div3S6').checked = false;
                    document.getElementById('div3S7').checked = false;
                    document.getElementById('div3S8').checked = false;
                }
            }
            if(id === 'div4All'){
                if (elem.checked) {
                    document.getElementById('div4S8').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div4S8').checked = false;
                }
            }
            if(document.getElementById('div1S3').checked && document.getElementById('div2S3').checked && document.getElementById('div3S3').checked){
                document.getElementById('allS3').checked = true;
            }
            if(document.getElementById('div1S4').checked && document.getElementById('div2S4').checked && document.getElementById('div3S4').checked){
                document.getElementById('allS4').checked = true;
            }
            if(document.getElementById('div1S5').checked && document.getElementById('div2S5').checked && document.getElementById('div3S5').checked){
                document.getElementById('allS5').checked = true;
            }
            if(document.getElementById('div1S6').checked && document.getElementById('div2S6').checked && document.getElementById('div3S6').checked){
                document.getElementById('allS6').checked = true;
            }
            if(document.getElementById('div1S7').checked && document.getElementById('div2S7').checked && document.getElementById('div3S7').checked){
                document.getElementById('allS7').checked = true;
            }
            if(document.getElementById('div1S8').checked && document.getElementById('div2S8').checked && document.getElementById('div3S8').checked && document.getElementById('div4S8').checked){
                document.getElementById('allS8').checked = true;
            }

            if(!document.getElementById('div1S3').checked || !document.getElementById('div2S3').checked || !document.getElementById('div3S3').checked){
                document.getElementById('allS3').checked = false;
            }
            if(!document.getElementById('div1S4').checked || !document.getElementById('div2S4').checked || !document.getElementById('div3S4').checked){
                document.getElementById('allS4').checked = false;
            }
            if(!document.getElementById('div1S5').checked || !document.getElementById('div2S5').checked || !document.getElementById('div3S5').checked){
                document.getElementById('allS5').checked = false;
            }
            if(!document.getElementById('div1S6').checked || !document.getElementById('div2S6').checked || !document.getElementById('div3S6').checked){
                document.getElementById('allS6').checked = false;
            }
            if(!document.getElementById('div1S7').checked || !document.getElementById('div2S7').checked || !document.getElementById('div3S7').checked){
                document.getElementById('allS7').checked = false;
            }
            if(!document.getElementById('div1S8').checked || !document.getElementById('div2S8').checked || !document.getElementById('div3S8').checked || !document.getElementById('div4S8').checked){
                document.getElementById('allS8').checked = false;
            }

            if(!cluster){
                    fetchData();
                }
            else{
                fetchDataCluster();
            }
            
        }

        function checkBoxAllSeason(elem){
            var id = elem.id;

            if(id === 'allS1'){
                if (elem.checked) {
                    document.getElementById('div1S1').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S1').checked = false;
                }
            }

            if(id === 'allS2'){
                if (elem.checked) {
                    document.getElementById('div1S2').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S2').checked = false;
                }
            }

            if(id === 'allS3'){
                if (elem.checked) {
                    document.getElementById('div1S3').checked = true;
                    document.getElementById('div2S3').checked = true;
                    document.getElementById('div3S3').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S3').checked = false;
                    document.getElementById('div2S3').checked = false;
                    document.getElementById('div3S3').checked = false;
                }
            }

            if(id === 'allS4'){
                if (elem.checked) {
                    document.getElementById('div1S4').checked = true;
                    document.getElementById('div2S4').checked = true;
                    document.getElementById('div3S4').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S4').checked = false;
                    document.getElementById('div2S4').checked = false;
                    document.getElementById('div3S4').checked = false;
                }
            }

            if(id === 'allS5'){
                if (elem.checked) {
                    document.getElementById('div1S5').checked = true;
                    document.getElementById('div2S5').checked = true;
                    document.getElementById('div3S5').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S5').checked = false;
                    document.getElementById('div2S5').checked = false;
                    document.getElementById('div3S5').checked = false;
                }
            }

            if(id === 'allS6'){
                if (elem.checked) {
                    document.getElementById('div1S6').checked = true;
                    document.getElementById('div2S6').checked = true;
                    document.getElementById('div3S6').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S6').checked = false;
                    document.getElementById('div2S6').checked = false;
                    document.getElementById('div3S6').checked = false;
                }
            }

            if(id === 'allS7'){
                if (elem.checked) {
                    document.getElementById('div1S7').checked = true;
                    document.getElementById('div2S7').checked = true;
                    document.getElementById('div3S7').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S7').checked = false;
                    document.getElementById('div2S7').checked = false;
                    document.getElementById('div3S7').checked = false;
                }
            }

            if(id === 'allS8'){
                if (elem.checked) {
                    document.getElementById('div1S8').checked = true;
                    document.getElementById('div2S8').checked = true;
                    document.getElementById('div3S8').checked = true;
                    document.getElementById('div4S8').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('div1S8').checked = false;
                    document.getElementById('div2S8').checked = false;
                    document.getElementById('div3S8').checked = false;
                    document.getElementById('div4S8').checked = false;
                }
            }

            if(document.getElementById('div1S1').checked && document.getElementById('div1S2').checked && document.getElementById('div1S3').checked && document.getElementById('div1S4').checked && document.getElementById('div1S5').checked && document.getElementById('div1S6').checked && document.getElementById('div1S7').checked && document.getElementById('div1S8').checked){
                document.getElementById('div1All').checked = true;
            }
            if(document.getElementById('div2S3').checked && document.getElementById('div2S4').checked && document.getElementById('div2S5').checked && document.getElementById('div2S6').checked && document.getElementById('div2S7').checked && document.getElementById('div2S8').checked){
                document.getElementById('div2All').checked = true;
            }
            if(document.getElementById('div3S3').checked && document.getElementById('div3S4').checked && document.getElementById('div3S5').checked && document.getElementById('div3S6').checked && document.getElementById('div3S7').checked && document.getElementById('div3S8').checked){
                document.getElementById('div3All').checked = true;
            }
            if(document.getElementById('div4S8').checked){
                document.getElementById('div4All').checked = true;
            }

            if(!document.getElementById('div1S1').checked || !document.getElementById('div1S2').checked || !document.getElementById('div1S3').checked || !document.getElementById('div1S4').checked || !document.getElementById('div1S5').checked || !document.getElementById('div1S6').checked || !document.getElementById('div1S7').checked || !document.getElementById('div1S8').checked){
                document.getElementById('div1All').checked = false;
            }
            if(!document.getElementById('div2S3').checked || !document.getElementById('div2S4').checked || !document.getElementById('div2S5').checked || !document.getElementById('div2S6').checked || !document.getElementById('div2S7').checked || !document.getElementById('div2S8').checked){
                document.getElementById('div2All').checked = false;
            }
            if(!document.getElementById('div3S3').checked || !document.getElementById('div3S4').checked || !document.getElementById('div3S5').checked || !document.getElementById('div3S6').checked || !document.getElementById('div3S7').checked || !document.getElementById('div3S8').checked){
                document.getElementById('div3All').checked = false;
            }
            if(!document.getElementById('div4S8').checked){
                document.getElementById('div4All').checked = false;
            }

            if(!cluster){
                fetchData();
            }
            else{
                fetchDataCluster();
            }
        }

        function checkBoxSingle(elem){
            var id = elem.id;

            if(id === 'div1S1'){
                if (elem.checked) {
                    document.getElementById('allS1').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('allS1').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
            }

            if(id === 'div1S2'){
                if (elem.checked) {
                    document.getElementById('allS2').checked = true;
                }
                else if (!elem.checked) {
                    document.getElementById('allS2').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
            }

            if(id === 'div1S3'){
                if (!elem.checked && document.getElementById('allS3').checked) {
                    document.getElementById('allS3').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S3').checked && document.getElementById('div3S3').checked){
                    document.getElementById('allS3').checked = true;
                }
            }

            if(id === 'div2S3'){
                if (!elem.checked && document.getElementById('allS3').checked) {
                    document.getElementById('allS3').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S3').checked && document.getElementById('div3S3').checked){
                    document.getElementById('allS3').checked = true;
                }
            }

            if(id === 'div3S3'){
                if (!elem.checked && document.getElementById('allS3').checked) {
                    document.getElementById('allS3').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S3').checked && document.getElementById('div1S3').checked){
                    document.getElementById('allS3').checked = true;
                }
            }

            if(id === 'div1S4'){
                if (!elem.checked && document.getElementById('allS4').checked) {
                    document.getElementById('allS4').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S4').checked && document.getElementById('div3S4').checked){
                    document.getElementById('allS4').checked = true;
                }
            }
            if(id === 'div2S4'){
                if (!elem.checked && document.getElementById('allS4').checked) {
                    document.getElementById('allS4').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S4').checked && document.getElementById('div3S4').checked){
                    document.getElementById('allS4').checked = true;
                }
            }
            if(id === 'div3S4'){
                if (!elem.checked && document.getElementById('allS4').checked) {
                    document.getElementById('allS4').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S4').checked && document.getElementById('div1S4').checked){
                    document.getElementById('allS4').checked = true;
                }
            }
            
            if(id === 'div1S5'){
                if (!elem.checked && document.getElementById('allS5').checked) {
                    document.getElementById('allS5').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S5').checked && document.getElementById('div3S5').checked){
                    document.getElementById('allS5').checked = true;
                }
            }

            if(id === 'div2S5'){
                if (!elem.checked && document.getElementById('allS5').checked) {
                    document.getElementById('allS5').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S5').checked && document.getElementById('div3S5').checked){
                    document.getElementById('allS5').checked = true;
                }
            }

            if(id === 'div3S5'){
                if (!elem.checked && document.getElementById('allS5').checked) {
                    document.getElementById('allS5').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S5').checked && document.getElementById('div1S5').checked){
                    document.getElementById('allS5').checked = true;
                }
            }
            
            if(id === 'div1S6'){
                if (!elem.checked && document.getElementById('allS6').checked) {
                    document.getElementById('allS6').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S6').checked && document.getElementById('div3S6').checked){
                    document.getElementById('allS6').checked = true;
                }
            }

            if(id === 'div2S6'){
                if (!elem.checked && document.getElementById('allS6').checked) {
                    document.getElementById('allS6').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S6').checked && document.getElementById('div3S6').checked){
                    document.getElementById('allS6').checked = true;
                }
            }

            if(id === 'div3S6'){
                if (!elem.checked && document.getElementById('allS6').checked) {
                    document.getElementById('allS6').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S6').checked && document.getElementById('div1S6').checked){
                    document.getElementById('allS6').checked = true;
                }
            }

            if(id === 'div1S7'){
                if (!elem.checked && document.getElementById('allS7').checked) {
                    document.getElementById('allS7').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S7').checked && document.getElementById('div3S7').checked){
                    document.getElementById('allS7').checked = true;
                }
            }

            if(id === 'div2S7'){
                if (!elem.checked && document.getElementById('allS7').checked) {
                    document.getElementById('allS7').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S7').checked && document.getElementById('div3S7').checked){
                    document.getElementById('allS7').checked = true;
                }
            }

            if(id === 'div3S7'){
                if (!elem.checked && document.getElementById('allS7').checked) {
                    document.getElementById('allS7').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S7').checked && document.getElementById('div1S7').checked){
                    document.getElementById('allS7').checked = true;
                }
            }

            if(id === 'div1S8'){
                if (!elem.checked && document.getElementById('allS8').checked) {
                    document.getElementById('allS8').checked = false;
                }
                if (!elem.checked && document.getElementById('div1All').checked) {
                    document.getElementById('div1All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S8').checked && document.getElementById('div3S8').checked && document.getElementById('div4S8').checked){
                    document.getElementById('allS8').checked = true;
                }
            }

            if(id === 'div2S8'){
                if (!elem.checked && document.getElementById('allS8').checked) {
                    document.getElementById('allS8').checked = false;
                }
                if (!elem.checked && document.getElementById('div2All').checked) {
                    document.getElementById('div2All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S8').checked && document.getElementById('div3S8').checked && document.getElementById('div4S8').checked){
                    document.getElementById('allS8').checked = true;
                }
            }

            if(id === 'div3S8'){
                if (!elem.checked && document.getElementById('allS8').checked) {
                    document.getElementById('allS8').checked = false;
                }
                if (!elem.checked && document.getElementById('div3All').checked) {
                    document.getElementById('div3All').checked = false;
                }
                if(elem.checked && document.getElementById('div2S8').checked && document.getElementById('div1S8').checked && document.getElementById('div4S8').checked){
                    document.getElementById('allS8').checked = true;
                }
            }

            if(id === 'div4S8'){
                if (!elem.checked && document.getElementById('allS8').checked) {
                    document.getElementById('allS8').checked = false;
                }
                if (!elem.checked && document.getElementById('div4All').checked) {
                    document.getElementById('div4All').checked = false;
                }
                if(elem.checked && document.getElementById('div1S8').checked && document.getElementById('div2S8').checked && document.getElementById('div3S8').checked){
                    document.getElementById('allS8').checked = true;
                }
            }

            if(document.getElementById('div1S1').checked && document.getElementById('div1S2').checked && document.getElementById('div1S3').checked && document.getElementById('div1S4').checked && document.getElementById('div1S5').checked && document.getElementById('div1S6').checked && document.getElementById('div1S7').checked && document.getElementById('div1S8').checked){
                document.getElementById('div1All').checked = true;
            }
            if(document.getElementById('div2S3').checked && document.getElementById('div2S4').checked && document.getElementById('div2S5').checked && document.getElementById('div2S6').checked && document.getElementById('div2S7').checked && document.getElementById('div2S8').checked){
                document.getElementById('div2All').checked = true;
            }
            if(document.getElementById('div3S3').checked && document.getElementById('div3S4').checked && document.getElementById('div3S5').checked && document.getElementById('div3S6').checked && document.getElementById('div3S7').checked && document.getElementById('div3S8').checked){
                document.getElementById('div3All').checked = true;
            }
            if(document.getElementById('div4S8').checked){
                document.getElementById('div4All').checked = true;
            }

            if(!cluster){
                fetchData();
            }
            else{
                fetchDataCluster();
            }
        }

        function checkBoxAllCactus(elem){
            var id = elem.id;

            if (elem.checked) {
                document.getElementById('cactusS1').checked = true;
                document.getElementById('cactusS2').checked = true;
                document.getElementById('cactusS3').checked = true;
                document.getElementById('cactusS4').checked = true;
                document.getElementById('cactusS5').checked = true;
                document.getElementById('cactusS6').checked = true;
                document.getElementById('cactusS7').checked = true;
                document.getElementById('cactusS8').checked = true;
            }
            else if (!elem.checked) {
                document.getElementById('cactusS1').checked = false;
                document.getElementById('cactusS2').checked = false;
                document.getElementById('cactusS3').checked = false;
                document.getElementById('cactusS4').checked = false;
                document.getElementById('cactusS5').checked = false;
                document.getElementById('cactusS6').checked = false;
                document.getElementById('cactusS7').checked = false;
                document.getElementById('cactusS8').checked = false;
            }

            if(!cluster){
                fetchDataCactus();
            }
            else{
                fetchDataCactusCluster();
            }
        }

        function checkBoxAllSeasonCactus(elem){
            var id = elem.id;

            if (!elem.checked && document.getElementById('cactusAll').checked) {
                document.getElementById('cactusAll').checked = false;
            }

            if(!cluster){
                fetchDataCactus();
            }
            else{
                fetchDataCactusCluster();
            }
        }


        function fetchData(){
            /*if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }*/

            if (document.getElementById('div1S1').checked) {
                if (layers[0].getLayers().length == 0) {
                    fetchJSONData("S1");
                }
                
            }
            else{
                if (map.hasLayer(layers[0])) {
                    layers[0].clearLayers();
                }
            }

            if (document.getElementById('div1S2').checked) {
                if (layers[1].getLayers().length == 0) {
                    fetchJSONData("S2");
                }
            }
            else{
                if (map.hasLayer(layers[1])) {
                    layers[1].clearLayers();
                }
            }

            if (document.getElementById('allS3').checked) {
                fetchJSONData("S3");
            }
            else {
                if (document.getElementById('div1S3').checked) {
                    if (layers[2].getLayers().length == 0) {
                        fetchJSONData("D1S3");
                    }
                }
                else{
                    if (map.hasLayer(layers[2])) {
                        layers[2].clearLayers();
                    }
                }
                if (document.getElementById('div2S3').checked) {
                    if (layers[3].getLayers().length == 0) {
                        fetchJSONData("D2S3");
                    }
                }
                else{
                    if (map.hasLayer(layers[3])) {
                        layers[3].clearLayers();
                    }
                }
                if (document.getElementById('div3S3').checked) {
                    if (layers[4].getLayers().length == 0) {
                        fetchJSONData("D3S3");
                    }
                }
                else{
                    if (map.hasLayer(layers[4])) {
                        layers[4].clearLayers();
                    }
                }
            }

            if (document.getElementById('allS4').checked) {
                fetchJSONData("S4");
            }
            else {
                if (document.getElementById('div1S4').checked) {
                    if (layers[5].getLayers().length == 0) {
                        fetchJSONData("D1S4");
                    }
                }
                else{
                    if (map.hasLayer(layers[5])) {
                        layers[5].clearLayers();
                    }
                }
                if (document.getElementById('div2S4').checked) {
                    if (layers[6].getLayers().length == 0) {
                        fetchJSONData("D2S4");
                    }
                }
                else{
                    if (map.hasLayer(layers[6])) {
                        layers[6].clearLayers();
                    }
                }
                if (document.getElementById('div3S4').checked) {
                    if (layers[7].getLayers().length == 0) {
                        fetchJSONData("D3S4");
                    }
                }
                else{
                    if (map.hasLayer(layers[7])) {
                        layers[7].clearLayers();
                    }
                }
            }

            if (document.getElementById('allS5').checked) {
                fetchJSONData("S5");
            }
            else {
                if (document.getElementById('div1S5').checked) {
                    if (layers[8].getLayers().length == 0) {
                        fetchJSONData("D1S5");
                    }
                }
                else{
                    if (map.hasLayer(layers[8])) {
                        layers[8].clearLayers();
                    }
                }
                if (document.getElementById('div2S5').checked) {
                    if (layers[9].getLayers().length == 0) {
                        fetchJSONData("D2S5");
                    }
                }
                else{
                    if (map.hasLayer(layers[9])) {
                        layers[9].clearLayers();
                    }
                }
                if (document.getElementById('div3S5').checked) {
                    if (layers[10].getLayers().length == 0) {
                        fetchJSONData("D3S5");
                    }
                }
                else{
                    if (map.hasLayer(layers[10])) {
                        layers[10].clearLayers();
                    }
                }
            }

            if (document.getElementById('allS6').checked) {
                fetchJSONData("S6");
            }
            else {
                if (document.getElementById('div1S6').checked) {
                    if (layers[11].getLayers().length == 0) {
                        fetchJSONData("D1S6");
                    }
                }
                else{
                    if (map.hasLayer(layers[11])) {
                        layers[11].clearLayers();
                    }
                }
                if (document.getElementById('div2S6').checked) {
                    if (layers[12].getLayers().length == 0) {
                        fetchJSONData("D2S6");
                    }
                }
                else{
                    if (map.hasLayer(layers[12])) {
                        layers[12].clearLayers();
                    }
                }
                if (document.getElementById('div3S6').checked) {
                    if (layers[13].getLayers().length == 0) {
                        fetchJSONData("D3S6");
                    }
                }
                else{
                    if (map.hasLayer(layers[13])) {
                        layers[13].clearLayers();
                    }
                }
            }

            if (document.getElementById('allS7').checked) {
                fetchJSONData("S7");
            }
            else {
                if (document.getElementById('div1S7').checked) {
                    if (layers[14].getLayers().length == 0) {
                        fetchJSONData("D1S7");
                    }
                }
                else{
                    if (map.hasLayer(layers[14])) {
                        layers[14].clearLayers();
                    }
                }
                if (document.getElementById('div2S7').checked) {
                    if (layers[15].getLayers().length == 0) {
                        fetchJSONData("D2S7");
                    }
                }
                else{
                    if (map.hasLayer(layers[15])) {
                        layers[15].clearLayers();
                    }
                }
                if (document.getElementById('div3S7').checked) {
                    if (layers[16].getLayers().length == 0) {
                        fetchJSONData("D3S7");
                    }
                }
                else{
                    if (map.hasLayer(layers[16])) {
                        layers[16].clearLayers();
                    }
                }
            }

            if (document.getElementById('allS8').checked) {
                fetchJSONData("S8");
            }
            else {
                if (document.getElementById('div1S8').checked) {
                    if (layers[17].getLayers().length == 0) {
                        fetchJSONData("D1S8");
                    }
                }
                else{
                    if (map.hasLayer(layers[17])) {
                        layers[17].clearLayers();
                    }
                }
                if (document.getElementById('div2S8').checked) {
                    if (layers[18].getLayers().length == 0) {
                        fetchJSONData("D2S8");
                    }
                }
                else{
                    if (map.hasLayer(layers[18])) {
                        layers[18].clearLayers();
                    }
                }
                if (document.getElementById('div3S8').checked) {
                    if (layers[19].getLayers().length == 0) {
                        fetchJSONData("D3S8");
                    }
                }
                else{
                    if (map.hasLayer(layers[19])) {
                        layers[19].clearLayers();
                    }
                }
                if (document.getElementById('div4S8').checked) {
                    if (layers[20].getLayers().length == 0) {
                        fetchJSONData("D4S8");
                    }
                }
                else{
                    if (map.hasLayer(layers[20])) {
                        layers[20].clearLayers();
                    }
                }
            }

        }

        function fetchDataCactus(){
            if (document.getElementById('cactusS1').checked) {
                if (layersCactus[0].getLayers().length == 0) {
                    fetchJSONDataCactus("S1");
                }
            }
            else{
                if (map.hasLayer(layersCactus[0])) {
                    layersCactus[0].clearLayers();
                }
            }

            if (document.getElementById('cactusS2').checked) {
                if (layersCactus[1].getLayers().length == 0) {
                    fetchJSONDataCactus("S2");
                }
            }
            else{
                if (map.hasLayer(layersCactus[1])) {
                    layersCactus[1].clearLayers();
                }
            }

            if (document.getElementById('cactusS3').checked) {
                if (layersCactus[2].getLayers().length == 0) {
                    fetchJSONDataCactus("S3");
                }
            }
            else{
                if (map.hasLayer(layersCactus[2])) {
                    layersCactus[2].clearLayers();
                }
            }

            if (document.getElementById('cactusS4').checked) {
                if (layersCactus[3].getLayers().length == 0) {
                    fetchJSONDataCactus("S4");
                }
            }
            else{
                if (map.hasLayer(layersCactus[3])) {
                    layersCactus[3].clearLayers();
                }
            }

            if (document.getElementById('cactusS5').checked) {
                if (layersCactus[4].getLayers().length == 0) {
                    fetchJSONDataCactus("S5");
                }
            }
            else{
                if (map.hasLayer(layersCactus[4])) {
                    layersCactus[4].clearLayers();
                }
            }

            if (document.getElementById('cactusS6').checked) {
                if (layersCactus[5].getLayers().length == 0) {
                    fetchJSONDataCactus("S6");
                }
            }
            else{
                if (map.hasLayer(layersCactus[5])) {
                    layersCactus[5].clearLayers();
                }
            }

            if (document.getElementById('cactusS7').checked) {
                if (layersCactus[6].getLayers().length == 0) {
                    fetchJSONDataCactus("S7");
                }
            }
            else{
                if (map.hasLayer(layersCactus[6])) {
                    layersCactus[6].clearLayers();
                }
            }
            if (document.getElementById('cactusS8').checked) {
                if (layersCactus[7].getLayers().length == 0) {
                    fetchJSONDataCactus("S8");
                }
            }
            else{
                if (map.hasLayer(layersCactus[7])) {
                    layersCactus[7].clearLayers();
                }
            }
        }

        function fetchDataCluster(){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }

            if (document.getElementById('div1S1').checked) {
                fetchJSONDataCluster("S1");
            }

            if (document.getElementById('div1S2').checked) {
                fetchJSONDataCluster("S2");
            }

            if (document.getElementById('allS3').checked) {
                fetchJSONDataCluster("S3");
            }
            else {
                if (document.getElementById('div1S3').checked) {
                    fetchJSONDataCluster("D1S3");
                }
                if (document.getElementById('div2S3').checked) {
                    fetchJSONDataCluster("D2S3");
                }
                if (document.getElementById('div3S3').checked) {
                    fetchJSONDataCluster("D3S3");
                }
            }

            if (document.getElementById('allS4').checked) {
                fetchJSONDataCluster("S4");
            }
            else {
                if (document.getElementById('div1S4').checked) {
                    fetchJSONDataCluster("D1S4");
                }
                if (document.getElementById('div2S4').checked) {
                    fetchJSONDataCluster("D2S4");
                }
                if (document.getElementById('div3S4').checked) {
                    fetchJSONDataCluster("D3S4");
                }
            }

            if (document.getElementById('allS5').checked) {
                fetchJSONDataCluster("S5");
            }
            else {
                if (document.getElementById('div1S5').checked) {
                    fetchJSONDataCluster("D1S5");
                }
                if (document.getElementById('div2S5').checked) {
                    fetchJSONDataCluster("D2S5");
                }
                if (document.getElementById('div3S5').checked) {
                    fetchJSONDataCluster("D3S5");
                }
            }

            if (document.getElementById('allS6').checked) {
                fetchJSONDataCluster("S6");
            }
            else {
                if (document.getElementById('div1S6').checked) {
                    fetchJSONDataCluster("D1S6");
                }
                if (document.getElementById('div2S6').checked) {
                    fetchJSONDataCluster("D2S6");
                }
                if (document.getElementById('div3S6').checked) {
                    fetchJSONDataCluster("D3S6");
                }
            }

            if (document.getElementById('allS7').checked) {
                fetchJSONDataCluster("S7");
            }
            else {
                if (document.getElementById('div1S7').checked) {
                    fetchJSONDataCluster("D1S7");
                }
                if (document.getElementById('div2S7').checked) {
                    fetchJSONDataCluster("D2S7");
                }
                if (document.getElementById('div3S7').checked) {
                    fetchJSONDataCluster("D3S7");
                }
            }

            if (document.getElementById('allS8').checked) {
                fetchJSONDataCluster("S8");
            }
            else {
                if (document.getElementById('div1S8').checked) {
                    fetchJSONDataCluster("D1S8");
                }
                if (document.getElementById('div2S8').checked) {
                    fetchJSONDataCluster("D2S8");
                }
                if (document.getElementById('div3S8').checked) {
                    fetchJSONDataCluster("D3S8");
                }
                if (document.getElementById('div4S8').checked) {
                    fetchJSONDataCluster("D4S8");
                }
            }

        }

        function fetchDataCactusCluster(){
            if (map.hasLayer(layerGroup)) {
                layerGroup.clearLayers();
            }

            if (document.getElementById('cactusS1').checked) {
                fetchJSONDataCactusCluster("S1");
            }

            if (document.getElementById('cactusS2').checked) {
                fetchJSONDataCactusCluster("S2");
            }

            if (document.getElementById('cactusS3').checked) {
                fetchJSONDataCactusCluster("S3");
            }

            if (document.getElementById('cactusS4').checked) {
                fetchJSONDataCactusCluster("S4");
            }

            if (document.getElementById('cactusS5').checked) {
                fetchJSONDataCactusCluster("S5");
            }

            if (document.getElementById('cactusS6').checked) {
                fetchJSONDataCactusCluster("S6");
            }

            if (document.getElementById('cactusS7').checked) {
                fetchJSONDataCactusCluster("S7");
            }

            if (document.getElementById('cactusS8').checked) {
                fetchJSONDataCactusCluster("S8");
            }
        }

    </script>
</body>
</html>